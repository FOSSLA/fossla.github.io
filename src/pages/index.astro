---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { Icon } from "astro-icon/components";
import heroBg from "@/assets/hero-bg.jpg";
import { getCollection } from "astro:content";

const features = [
  { icon: "lucide:code-2", title: "Open Source Projects", description: "Collaborate on initiatives that benefit Ladakh and beyond." },
  { icon: "lucide:users", title: "Community Driven", description: "Learn from peers, share knowledge, and grow together." },
  { icon: "lucide:book-open", title: "Workshops & Training", description: "Regular sessions on FOSS technologies and best practices." },
  { icon: "lucide:calendar", title: "Events & Meetups", description: "Hackathons, install-fests, and community gatherings." }
];

const posts = (await getCollection("blog"))
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 3);
---
<BaseLayout 
  title="FOSS LA — Free & Open Source Software Community in Ladakh"
  description="Join FOSS LA, Ladakh's thriving community for open source software. Collaborate on projects, attend workshops, and connect with developers, students, and FOSS enthusiasts."
>
  <section class="relative min-h-[90vh] overflow-hidden">
    <div
      class="absolute inset-0"
      style={`background-image:url(${heroBg.src}); background-size:cover; background-position:center;`}
    >
      <div class="absolute inset-0 bg-gradient-to-b from-background/95 via-background/80 to-background" />
    </div>
    <div class="relative z-10 flex min-h-[90vh] flex-col items-center justify-center px-4 text-center">
      <div class="mb-8 inline-flex items-center gap-2 rounded-full border border-primary/30 bg-primary/5 px-4 py-2">
        <Icon name="lucide:terminal" class="h-4 w-4 text-primary" />
        <span class="text-sm uppercase tracking-wide text-primary">Open Source • Free Software • Community</span>
      </div>
      <h1 class="mb-6 text-5xl font-bold md:text-7xl">
        <span class="text-foreground">Welcome to </span>
        <span class="text-primary">FOSS LA</span>
      </h1>
      <p class="mx-auto mb-8 max-w-3xl text-xl text-muted-foreground md:text-2xl">
        Building a thriving Free and Open Source Software community in Ladakh.
      </p>
      <div class="flex flex-col justify-center gap-4 sm:flex-row">
        <a
          href="https://t.me/fossla"
          class="group inline-flex items-center justify-center rounded border border-primary bg-primary px-6 py-3 text-lg font-semibold text-primary-foreground transition hover:bg-primary/90"
        >
          Join the Community
          <Icon name="lucide:arrow-right" class="ml-2 h-4 w-4 transition group-hover:translate-x-1" />
        </a>
        <a
          href="/projects"
          class="inline-flex items-center justify-center rounded border border-border px-6 py-3 text-lg font-semibold text-foreground transition hover:border-primary"
        >
          Explore Projects
        </a>
      </div>
    </div>
  </section>

  <section class="bg-card/30 py-20">
    <div class="container mx-auto px-4">
      <div class="mb-16 text-center">
        <h2 class="mb-4 text-3xl font-bold md:text-4xl">
          Why <span class="text-primary">FOSS LA</span>?
        </h2>
        <p class="mx-auto max-w-2xl text-lg text-muted-foreground">
          We're building more than just software—we're building a community that empowers through technology.
        </p>
      </div>
      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-4">
        {features.map((feature) => (
          <div class="rounded border border-border bg-card/40 p-6 transition hover:border-primary/50 hover:shadow-[0_0_20px_hsl(var(--primary)/0.2)]">
            <div class="mb-4 flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10">
              <Icon name={feature.icon} class="h-6 w-6 text-primary" />
            </div>
            <h3 class="mb-2 text-lg font-semibold">{feature.title}</h3>
            <p class="text-sm text-muted-foreground">{feature.description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <section class="py-20">
    <div class="container mx-auto px-4">
      <div class="mb-12 flex flex-col items-start justify-between gap-6 md:flex-row md:items-center">
        <div>
          <h2 class="text-3xl font-bold md:text-4xl">Latest from the Blog</h2>
          <p class="text-muted-foreground">Stay updated with our community activities.</p>
        </div>
        <a href="/blog" class="rounded border border-border px-6 py-2 text-sm font-semibold hover:border-primary">
          View All
        </a>
      </div>
      <div class="grid gap-6 md:grid-cols-3">
        {posts.map((post) => (
          <article class="flex flex-col rounded border border-border bg-card/40 p-6 transition hover:border-primary/50">
            <div class="mb-4 flex items-center gap-2 text-xs">
              <span class="rounded bg-primary/10 px-2 py-1 text-primary">{post.data.category}</span>
              <span class="text-muted-foreground">{post.data.date.toLocaleDateString()}</span>
            </div>
            <h3 class="mb-3 text-xl font-semibold text-foreground transition hover:text-primary">
              <a href={`/blog/${post.slug}`}>{post.data.title}</a>
            </h3>
            <p class="mb-4 flex-1 text-sm text-muted-foreground">{post.data.description}</p>
            <a href={`/blog/${post.slug}`} class="inline-flex items-center text-sm text-primary">
              Read more
              <Icon name="lucide:arrow-right" class="ml-1 h-4 w-4" />
            </a>
          </article>
        ))}
      </div>
    </div>
  </section>

  <section class="border-y border-primary/20 bg-primary/5 py-20">
    <div class="container mx-auto px-4 text-center">
      <Icon name="lucide:rocket" class="mx-auto mb-6 h-16 w-16 text-primary" />
      <h2 class="mb-4 text-3xl font-bold md:text-4xl">Ready to Get Started?</h2>
      <p class="mx-auto mb-8 max-w-2xl text-lg text-muted-foreground">
        Join our community of developers, students, and FOSS enthusiasts in Ladakh.
      </p>
      <div class="flex flex-col justify-center gap-4 sm:flex-row">
        <a href="https://t.me/fossla" class="rounded border border-primary bg-primary px-6 py-3 font-semibold text-primary-foreground">
          Join Community
        </a>
        <a href="/events" class="rounded border border-border px-6 py-3 font-semibold text-foreground hover:border-primary">
          Attend an Event
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
